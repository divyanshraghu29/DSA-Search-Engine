b"\nRead problem statements in Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nYou are given a tree with N nodes (numbered 1 through N), rooted at node 1. For each valid i, node i has a value a_i written on it.\nAn undirected simple path between any two nodes u and v is said to be vertical if u=v or u is an ancestor of v or v is an ancestor of u. Let's define a vertical partition of the tree as a set of vertical paths such that each node belongs to exactly one of these paths.\nYou are also given a sequence of N integers b_1, b_2, \\ldots, b_N. A vertical partition is good if, for each of its paths, we can permute the values written on the nodes in this path, and this can be done in such a way that we reach a state where for each valid i, the value written on node i is b_i.\nThe difficulty of your task is described by a parameter S. If S=1, your task is only to determine whether at least one good vertical partition exists. If S=2, you are required to find the number of good vertical partitions modulo 1,000,000,007 (10^9+7).\nInput\n\nThe first line of the input contains a single integer T denoting the number of test cases. The description of T test cases follows.\nThe first line of each test case contains two space-separated integers N and S.\nEach of the next N-1 lines contains two space-separated integers u and v denoting that nodes u and v are connected by an edge.\nThe next line contains N space-separated integers a_1, a_2, \\ldots, a_N.\nThe line after that contains N space-separated integers b_1, b_2, \\ldots, b_N.\n\nOutput\nFor each test case, print a single line containing one integer:\n\nIf S=1, this integer should be 1 if a good vertical partition exists or 0 if it does not exist.\nIf S=2, this integer should be the number of good vertical partitions modulo 1,000,000,007 (10^9+7).\n\nConstraints\n\n1 \\le T \\le 10^6\n1 \\leq N \\leq 10^5\nS \\in \\{1, 2\\}\n1 \\leq u, v \\leq N\nthe graph described on the input is a tree\n1 \\leq a_i, b_i \\leq 10^6 for each valid i\nthe sum of N over all test cases does not exceed 10^6\n\nSubtasks\nSubtask #1 (40 points, time limit 1 seconds): the sum of N over all test cases does not exceed 1,000\nSubtask #2 (30 points, time limit 2 seconds): S = 1\nSubtask #3 (30 points, time limit 2 seconds): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n4\n3 2\n1 2\n2 3\n4 5 6\n4 6 5\n6 2\n1 2\n1 3\n2 4\n3 5\n3 6\n10 20 30 40 50 60\n10 40 50 20 30 60\n6 1\n1 2\n1 3\n2 4\n3 5\n3 6\n10 20 30 40 50 60\n10 40 50 20 30 60\n1 2\n1\n2\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n2\n3\n1\n0\n\n\nExplanation\nExample case 1: The good vertical partitions are \\{[1], [2, 3]\\} and \\{[1, 2, 3]\\}.\nExample case 2: The good vertical partitions are:\n\n\\{[1, 2, 4], [3, 5], [6]\\}\n\\{[1], [2, 4], [3, 5], [6]\\}\n\\{[1, 3, 5], [2, 4], [6]\\}\n\nExample case 3: The same as example case 2, but with S=1.\nExample case 4: There is no good vertical partition.\n\n\n\nAuthor:\na7med1080\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/TREEPERM\n\n\nTags:\n\n               \n                 Deque, Trees, Multiset, Dynamic Programming, Greedy, DFS, BFS\n                 \n                     \n                     Data Structures, Queues, Graphs, Sets, Algorithms, Graph Algos, Traversals\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2367\n\n\nDate Added:\n26-01-2021\n\n\nTime Limit:\n1 - 2 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"