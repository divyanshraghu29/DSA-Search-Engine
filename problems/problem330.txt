b"\nRead problem statements in Hindi, Bengali, Mandarin Chinese, Russian, and Vietnamese as well.\nChef gave you a sequence of integers a1,a2,\xe2\x80\xa6,aNa1,a2,\xe2\x80\xa6,aN and 3 integers K, m and x. Let's define the following functions:\nG(i1,\xe2\x80\xa6,iK)=gcd(ai1,\xe2\x80\xa6,aiK)\nSx(i1,\xe2\x80\xa6,iK)=axi1+axi2+\xe2\x80\xa6+axiK\nPm(i1,\xe2\x80\xa6,iK)=(ai1\xe2\x8b\x85ai2\xe2\x8b\x85\xe2\x80\xa6\xe2\x8b\x85aiK)m\nW(T)=smallestprimedivisorofP1(T)\nChef wants you to compute the sum of G(T)\xe2\x8b\x85W(T)\xe2\x8b\x85Sx(T)\xe2\x8b\x85Pm(T) over all K-tuples of indices T=(i1,i2,\xe2\x80\xa6,iK) such that ij\xe2\x88\x88{1,2,\xe2\x80\xa6,N} for each valid j (there are NK of these K-tuples). Since this sum could be enormous, compute it modulo 109+7.\nInput\n\nThe first line of the input contains four space-separated integers N, K, m and x.\nThe second line contains N space-separated integers a1,a2,\xe2\x80\xa6,aN.\n\nOutput\nPrint a single line containing one integer \xe2\x88\x91TG(T)\xe2\x8b\x85W(T)\xe2\x8b\x85Sx(T)\xe2\x8b\x85Pm(T) modulo 109+7.\nConstraints\n\n1\xe2\x89\xa4N\xe2\x89\xa4106\n1\xe2\x89\xa4K,m,x\xe2\x89\xa41018\n2\xe2\x89\xa4ai\xe2\x89\xa4106 for each valid i\n\nSubtasks\nSubtask #1 (5 points):\n\nN\xe2\x89\xa410\nK\xe2\x89\xa46\n\nSubtask #2 (20 points): for each valid i, ai is even\nSubtask #3 (75 points): original constraints\n\n                        Sample Input 1\n                        \n\n\n\n\n\n3 2 1 1\n2 3 4\n\n\n\n                        Sample Output 1\n                        \n\n\n\n\n\n2414\n\n\nExplanation\nExample case 1: We have NK=32=9 possible pairs T of indices. The corresponding summands are:\n\nT=(1,1): gcd(2,2)\xe2\x8b\x85(21+21)\xe2\x8b\x85(2\xe2\x8b\x852)1\xe2\x8b\x852=64\nT=(1,2): gcd(2,3)\xe2\x8b\x85(21+31)\xe2\x8b\x85(2\xe2\x8b\x853)1\xe2\x8b\x852=60\nT=(1,3): gcd(2,4)\xe2\x8b\x85(21+41)\xe2\x8b\x85(2\xe2\x8b\x854)1\xe2\x8b\x852=192\nT=(2,1): gcd(3,2)\xe2\x8b\x85(31+21)\xe2\x8b\x85(3\xe2\x8b\x852)1\xe2\x8b\x852=60\nT=(2,2): gcd(3,3)\xe2\x8b\x85(31+31)\xe2\x8b\x85(3\xe2\x8b\x853)1\xe2\x8b\x853=486\nT=(2,3): gcd(3,4)\xe2\x8b\x85(31+41)\xe2\x8b\x85(3\xe2\x8b\x854)1\xe2\x8b\x852=168\nT=(3,1): gcd(4,2)\xe2\x8b\x85(41+21)\xe2\x8b\x85(4\xe2\x8b\x852)1\xe2\x8b\x852=192\nT=(3,2): gcd(4,3)\xe2\x8b\x85(41+31)\xe2\x8b\x85(4\xe2\x8b\x853)1\xe2\x8b\x852=168\nT=(3,3): gcd(4,4)\xe2\x8b\x85(41+41)\xe2\x8b\x85(4\xe2\x8b\x854)1\xe2\x8b\x852=1024\n\nTheir sum modulo 109+7 is 2414.\n\n\n\nAuthor:\nwm101\n\n\nEditorial:\nhttps://discuss.codechef.com/problems/CHEFSUMS\n\n\nTags:\n\n               \n                 dynamic-programming, hard, math, sept20, wm101, wm101\n                 \n               \n             \n             \n\n\n\n                        Difficulty Rating:\n                    \n\n2899\n\n\nDate Added:\n22-07-2020\n\n\nTime Limit:\n1 secs\n\n\nSource Limit:\n50000 Bytes\n\n\nLanguages:\nCPP17, PYTH 3.6, JAVA, C, CPP14, PYTH, PYP3, CS2, ADA, PYPY, TEXT, PAS fpc, NODEJS, RUBY, PHP, GO, HASK, TCL, kotlin, PERL, SCALA, LUA, BASH, JS, rust, LISP sbcl, PAS gpc, BF, CLOJ, R, D, CAML, swift, FORT, ASM, FS, WSPC, LISP clisp, SQL, SCM guile, PERL6, ERL, CLPS, PRLG, SQLQ, ICK, NICE, ICON, COB, SCM chicken, PIKE, SCM qobi, ST, NEM\n\n\n\n\n\nSubmit\n\n"