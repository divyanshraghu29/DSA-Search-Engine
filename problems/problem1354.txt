b'B. Heidi and Library (medium)time limit per test10 secondsmemory limit per test256 megabytesinputstandard inputoutputstandard outputWhereas humans nowadays read fewer and fewer books on paper, book readership among marmots has surged. Heidi has expanded the library and is now serving longer request sequences.InputSame as the easy version, but the limits have changed: 1???n,?k???400?000.OutputSame as the easy version.ExamplesInputCopy4 1001 2 2 1OutputCopy2InputCopy4 11 2 2 1OutputCopy3InputCopy4 21 2 3 1OutputCopy3'